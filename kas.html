<table id="tabel">
  <thead>
    <tr>
      <th>No</th>
      <th>Tanggal</th>
      <th>Nama</th>
      <th>Jenis</th>
      <th>Jumlah Masuk</th>
      <th>Jumlah Keluar</th>
      <th>Keterangan</th>
      <th>Foto Bukti</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<p>Total Masuk: <span id="totalMasuk">0</span></p>
<p>Total Keluar: <span id="totalKeluar">0</span></p>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbydLvjw4vWiFL4OZCKpSg5Xgx0N4VYEP9yB7IyNFiWXaL0Ef-Bpbp4-CtdbKQ5aJ-yQxg/exec";

function tampilKas(){
  var kode = document.getElementById("kode").value;
  var bulan = document.getElementById("bulan").value;

  fetch(`${API_URL}?kode=${kode}&bulan=${bulan}`)
    .then(res => res.json())
    .then(res => {
      var data = res.data;
      var tbody = document.querySelector("#tabel tbody");
      tbody.innerHTML = "";
      data.forEach((row,i)=>{
        var tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${i+1}</td>
          <td>${row[0]}</td>
          <td>${row[1]}</td>
          <td>${row[2]}</td>
          <td>${row[3]}</td>
          <td>${row[4]}</td>
          <td>${row[5]}</td>
          <td>${row[6] ? `<img src="${row[6]}" onclick="window.open('${row[6]}')" />` : "-"}</td>
        `;
        tbody.appendChild(tr);
      });
      document.getElementById("totalMasuk").textContent = res.totalMasuk;
      document.getElementById("totalKeluar").textContent = res.totalKeluar;
    })
    .catch(err => alert("Gagal ambil data: "+err));
}
</script>
