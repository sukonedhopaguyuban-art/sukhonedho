<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Menu Kas</title>
  <style>
    table, th, td { border:1px solid #ccc; border-collapse:collapse; padding:5px;}
    img { max-width:100px; cursor:pointer; }
  </style>
</head>
<body>

<h2>Menu Kas</h2>

<label>Kode:</label>
<input type="text" id="kode"><br><br>

<label>Bulan:</label>
<select id="bulan">
  <option value="1">Januari</option>
  <option value="2">Februari</option>
  <option value="3">Maret</option>
  <option value="4">April</option>
  <option value="5">Mei</option>
  <option value="6">Juni</option>
  <option value="7">Juli</option>
  <option value="8">Agustus</option>
  <option value="9">September</option>
  <option value="10">Oktober</option>
  <option value="11">November</option>
  <option value="12">Desember</option>
</select><br><br>

<button onclick="tampilKas()">Tampilkan</button>

<table id="tabel">
  <thead>
    <tr>
      <th>No</th>
      <th>Tanggal</th>
      <th>Nama</th>
      <th>Jenis</th>
      <th>Keterangan</th>
      <th>Foto Bukti</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwJWJCGglENqaTvOSUFfgwcH-CBv0aCdO9NysYuBh6o74ByDIcBQGg6Ho69W3D0REHPzQ/exec"; // ganti dengan URL Web App yang sudah dideploy

function tampilKas(){
  var kode = document.getElementById("kode").value;
  var bulan = document.getElementById("bulan").value;

  fetch(`${API_URL}?kode=${kode}&bulan=${bulan}`)
    .then(res => res.json())
    .then(data => {
      var tbody = document.querySelector("#tabel tbody");
      tbody.innerHTML = "";
      data.forEach((row,i)=>{
        var tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${i+1}</td>
          <td>${row[0]}</td>
          <td>${row[1]}</td>
          <td>${row[2]}</td>
          <td>${row[3]}</td>
          <td>${row[4] ? `<img src="${row[4]}" onclick="window.open('${row[4]}')" />` : "-"}</td>
        `;
        tbody.appendChild(tr);
      });
    })
    .catch(err => alert("Gagal ambil data: "+err));
}
</script>

</body>
</html>
